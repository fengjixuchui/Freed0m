# Crypto

[toc]



## RSA

RSA加密算法是一种非对称加密算法，在公开密钥加密和电子商业中被广泛使用。RSA是由罗纳德·李维斯特（Ron Rivest）、阿迪·萨莫尔（Adi Shamir）和伦纳德·阿德曼（Leonard Adleman）在1977年一起提出的。

RSA 算法涉及三个参数, n,e,d，其中分为私钥和公钥，私钥是 n,d，公钥是 n,e。n 是两个素数的乘积，一般这两个素数在 RSA 中用字母 p,q 表示。e 是一个素数。d 是 e 模 phi(n) 的逆元，d 是由 e,p,q 可以求解出的。明文表示为 m。然后通过 RSA 加密，得到密文 C。

一般来说，n，e 是公开的，但是由于 n 一般是两个大素数的乘积，所以我们很难求解出 d，所以 RSA 加密就是利用现代无法快速实现大素数的分解，所存在的一种安全的非对称加密。

### 已知 e、n、密文 c，求明文 m

给出 n、e、密文 c

```
e = 65537
n = 1455925529734358105461406532259911790807347616464991065301847
c = 69380371057914246192606760686152233225659503366319332065009
```



```py
import gmpy2
import binascii

e = 65537
n = 1455925529734358105461406532259911790807347616464991065301847
c = 69380371057914246192606760686152233225659503366319332065009
#1.将n分解为p和q
p = 1201147059438530786835365194567
q = 1212112637077862917192191913841

phi = (p-1)*(q-1)
#2.求d
d = gmpy2.invert(e,phi)
#3.m=pow(c,d,n)
m = gmpy2.powmod(c,d,n)
print(binascii.unhexlify(hex(m)[2:]))
#binascii.unhexlify(hexstr):从十六进制字符串hexstr返回二进制数据
```




